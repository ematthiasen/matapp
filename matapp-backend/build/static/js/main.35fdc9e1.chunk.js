(this["webpackJsonpmatapp-frontend"]=this["webpackJsonpmatapp-frontend"]||[]).push([[0],{199:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(45),c=n.n(r),o=n(15),i=n.n(o),s=n(22),l=n(265),u=n(267),d=n(268),j=n(242),b=n(253),p=n(273),f=n(20),O=n(31),h=n.n(O),x="/api/fooditems",g=null,m=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},console.log("config:",n),e.next=4,h.a.post(x,t,n);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},console.log("config:",n),e.next=4,h.a.delete("".concat(x,"/").concat(t),n);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E={setToken:function(e){g="bearer ".concat(e),console.log("token set:",g)},getAll:function(){return console.log("getting all?"),h.a.get(x)},createFooditem:m,updateFooditem:function(e,t){return h.a.put("".concat(x,"/").concat(e),t)},deleteFooditem:v},y=function(e){return function(){var t=Object(s.a)(i.a.mark((function t(n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E.createFooditem(e);case 3:return a=t.sent,console.log("DB created fooditem: ",a.data),t.next=7,n({type:"ADD_FOODITEM",data:a.data});case 7:return t.abrupt("return",a.data);case 10:return t.prev=10,t.t0=t.catch(0),console.log("testing",t.t0.response.data.error),t.abrupt("return",t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()},w=function(e){return function(){var t=Object(s.a)(i.a.mark((function t(n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E.deleteFooditem(e);case 3:return a=t.sent,console.log("Deleted:",a),t.next=7,n({type:"DELETE_FOODITEM",data:e});case 7:return t.abrupt("return",null);case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_FOODITEMS":return t.data;case"ADD_FOODITEM":return e.concat(t.data);case"DELETE_FOODITEM":var n=e.filter((function(e){return e.id!==t.data}));return n;default:return e}},I=function(e){return{type:"SET_TIMER",data:{timeoutHandle:e}}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TIMER":return window.clearTimeout(e),t.data.timeoutHandle;case"CLEAR_TIMER":return clearTimeout(e),null;default:return e}},k=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;return console.log("creating notification!"),function(){var a=Object(s.a)(i.a.mark((function a(r){return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r(S(e,t));case 2:return a.next=4,r(I(setTimeout((function(){r(R())}),n)));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},S=function(e,t){return{type:"SET_NOTIFICATION",data:{messageText:e,messageType:t}}},R=function(){return console.log("clearing!"),{type:"CLEAR_NOTIFICATION"}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.data;case"CLEAR_NOTIFICATION":return null;default:return e}},D=n(1),N=function(e){var t=e.fooditemObject,n=void 0===t?{}:t,a=e.onSuccess,r=void 0===a?function(){return null}:a,c=e.onCancel,o=Object(f.b)(),O=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log("Adding food item",t.target.food.value),n={name:t.target.food.value,protein:t.target.protein.value,fat:t.target.fat.value,carbohydrate:t.target.carb.value},e.next=5,o(y(n));case 5:(a=e.sent)instanceof Error?o(k(a.response.data.error)):(t.target.food.value="",t.target.carbs.value="",t.target.protein.value="",t.target.fat.value="",console.log("returnValue sending back:",a),r(a));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsx)(l.a,{variant:"outlined",children:Object(D.jsxs)(u.a,{children:[Object(D.jsx)(d.a,{variant:"h5",children:"Create fooditem"}),Object(D.jsx)("form",{onSubmit:O,onReset:c,children:Object(D.jsxs)(j.a,{direction:"column",spacing:1,children:[Object(D.jsx)(b.a,{name:"food",id:"food-name",variant:"outlined",label:"Food name",defaultValue:n.name}),Object(D.jsx)(b.a,{name:"carb",inputProps:{inputMode:"numeric",pattern:"([0-9]+\\[.,]?[0-9]*|\\[.,][0-9]+)"},id:"carbs",variant:"outlined",label:"Carbohydrates (per 100g)"}),Object(D.jsx)(b.a,{name:"fat",inputProps:{inputMode:"numeric",pattern:"([0-9]+\\[.,]?[0-9]*|\\[.,][0-9]+)"},id:"fat",variant:"outlined",label:"Fat (per 100g)"}),Object(D.jsx)(b.a,{name:"protein",inputProps:{inputMode:"numeric",pattern:"([0-9]+\\[.,]?[0-9]*|\\[.,][0-9]+)"},id:"protein",variant:"outlined",label:"Protein (per 100g)"}),Object(D.jsx)(p.a,{variant:"contained",type:"submit",children:"Create"}),Object(D.jsx)(p.a,{variant:"outlined",type:"reset",children:"Cancel"})]})})]})})},F=n(25),_=n(146),P=function(e){return{type:"SET_RECIPE",data:e}},U=function(e){return console.log("Ingredient: ",e),{type:"ADD_INGREDIENT",data:Object(F.a)(Object(F.a)({},e),{},{id:Math.floor(1e4*Math.random())})}},L=function(e,t){return{type:"UPDATE_INGREDIENT_AMOUNT",data:{ingredientId:e,newAmount:t}}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_RECIPE":return t.data;case"ADD_INGREDIENT":var n=t.data,a=e.ingredients.concat(n);return Object(F.a)(Object(F.a)({},e),{},{ingredients:a});case"UPDATE_INGREDIENT_AMOUNT":var r=e.ingredients.find((function(e){return e.id===t.data.ingredientId})),c=Object(F.a)(Object(F.a)({},r),{},{amount:t.data.newAmount}),o=e.ingredients.map((function(e){return e.id!==c.id?e:c}));return Object(F.a)(Object(F.a)({},e),{},{ingredients:o});case"DELETE_INGREDIENT":var i=e.ingredients.filter((function(e){return e.id!==t.data.ingredientId}));return Object(F.a)(Object(F.a)({},e),{},{ingredients:i});default:return e}},z=n(19),W="/api/recipes",V=null,G={getAll:function(){return h.a.get(W)},getRecipe:function(e){return console.log("getting local recipe"),h.a.get("".concat(W,"/").concat(e))},createRecipe:function(e){var t={headers:{Authorization:V}};return h.a.post(W,e,t)},updateRecipe:function(e){if(null===V){var t=new Error;throw t.name="AuthenticationError",t.message="You need to be logged in in order to save to server",t}var n={headers:{Authorization:V}};return h.a.put("".concat(W,"/").concat(e.id),e,n)},deleteRecipe:function(e){if(null===V){var t=new Error;throw t.name="AuthenticationError",t.message="You need to be logged in in order to delete recipe",t}var n={headers:{Authorization:V}};return h.a.delete("".concat(W,"/").concat(e.id),n)},setToken:function(e){V="bearer ".concat(e),console.log("token set:",V)},addIngredientToRecipe:function(e,t){if(null===V){var n=new Error;throw n.name="AuthenticationError",n.message="You need to be logged in in order to modify a recipe",n}var a={headers:{Authorization:V}};return h.a.post("".concat(W,"/").concat(e.id,"/ingredients"),t,a)},updateIngredientInRecipe:function(e,t){if(null===V){var n=new Error;throw n.name="AuthenticationError",n.message="You need to be logged in in order to modify a recipe",n}var a={headers:{Authorization:V}};return h.a.put("".concat(W,"/").concat(e.id,"/ingredients/").concat(t.id),t,a)},deleteIngredientFromRecipe:function(e,t){if(null===V){var n=new Error;throw n.name="AuthenticationError",n.message="You need to be logged in in order to modify a recipe",n}var a={headers:{Authorization:V}};return h.a.delete("".concat(W,"/").concat(e.id,"/ingredients/").concat(t),a)},updateAllIngredients:function(e,t){if(null===V){var n=new Error;throw n.name="AuthenticationError",n.message="You need to be logged in in order to modify a recipe",n}var a={headers:{Authorization:V}};return h.a.put("".concat(W,"/").concat(e.id,"/ingredients"),t,a)}},J=function(e){return{type:"ADD_RECIPE",data:e}},Y=function(e){return{type:"DELETE_RECIPE",data:e}},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_RECIPES":return t.data;case"ADD_RECIPE":return e.concat(t.data);case"UPDATE_RECIPE":var n=e.find((function(e){return e.id===t.data.id}));return console.log("Updated recipe ",n),e.map((function(e){return e.id!==t.data.id?e:t.data}));case"DELETE_RECIPE":var a=e.filter((function(e){return e.id!==t.data.id}));return a;default:return e}},H=n(10),K=n(274),X=n(275),q=n(276),Q=n(277),Z=n(271),$=n(278),ee=n(69),te=n.n(ee),ne=function(e){var t=e.recipe,n=e.handleCloneRecipe,r=e.handleShowRecipe,c=e.handleDeleteRecipe,o=Object(a.useState)(!1),i=Object(H.a)(o,2),s=i[0],l=i[1],u=Object(a.useState)(null),j=Object(H.a)(u,2),b=j[0],f=j[1],O=function(){f(null)};return Object(D.jsxs)(K.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(D.jsx)(X.a,{component:"th",scope:"row",children:t.title}),Object(D.jsx)(X.a,{children:t.date}),Object(D.jsx)(X.a,{children:t.owner.username}),Object(D.jsx)(X.a,{align:"right",size:"small",children:Object(D.jsxs)(q.a,{children:[Object(D.jsx)(p.a,{variant:"contained",onClick:function(){return n(t)},children:"Copy"}),t.template?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(p.a,{variant:"outlined",children:"Edit"}),Object(D.jsx)(Q.a,{"aria-label":"delete",disabled:!0,children:Object(D.jsx)(te.a,{})})]}):Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(p.a,{variant:"contained",onClick:function(){return r(t)},children:"Edit"}),Object(D.jsx)(Q.a,{"aria-label":"delete",color:"primary",onClick:function(e){f(e.currentTarget)},children:Object(D.jsx)(te.a,{})}),Object(D.jsx)(Z.a,{component:"div",id:"confirm-dialog",open:Boolean(b),anchorEl:b,onClose:O,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:Object(D.jsxs)($.a,{sx:{alignContent:"right",p:1},children:[Object(D.jsx)(d.a,{variant:"body1",sx:{color:"inherit",p:2},children:"Really delete?"}),Object(D.jsxs)(q.a,{children:[Object(D.jsx)(p.a,{variant:"contained",color:"warning",onClick:function(){f(null),c(t)},children:"Yes"}),Object(D.jsx)(p.a,{variant:"outlined",onClick:O,children:"Cancel"})]})]})})]})]})}),Object(D.jsx)("br",{}),s?Object(D.jsxs)($.a,{children:["Really delete?",Object(D.jsx)("button",{onClick:function(){return c(t)},children:"Yes"}),Object(D.jsx)("button",{onClick:function(){return l(!1)},children:"No"})," "]}):Object(D.jsx)(D.Fragment,{})]},t.id)},ae=n(279),re=n(280),ce=n(281),oe=n(282),ie=n(266),se=["id"],le=function(){var e=Object(f.c)((function(e){return e.recipes})),t=Object(f.b)(),n=Object(z.f)(),a=function(e){console.log("handled show recipe"),t(P(e)),n.push("/recipe/".concat(e.id))},r=function(){var e=Object(s.a)(i.a.mark((function e(a){var r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.id,r=Object(_.a)(a,se),console.log("WithoutID?",r),r=Object(F.a)(Object(F.a)({},r),{},{template:!1}),(new Date).toLocaleDateString("no-no"),console.log(r.name),e.prev=5,e.next=8,G.createRecipe(r);case 8:c=e.sent,t(J(c.data)),n.push("/recipe/".concat(c.data.id)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.log("Failed to clone recipe");case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(s.a)(i.a.mark((function e(n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Delete clicked for recipe: ",n.id),e.prev=1,e.next=4,G.deleteRecipe(n);case 4:a=e.sent,console.log("deleted recipe",a),t(Y(n)),t(k("Recipe deleted")),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),401===e.t0.response.status?t(k("Could not delete recipe: Not authorized")):t(k(e.t0.response.data.error));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsx)(ae.a,{component:ie.a,children:Object(D.jsxs)(re.a,{sx:{minWidth:650},"aria-label":"simple table",children:[Object(D.jsx)(ce.a,{children:Object(D.jsxs)(K.a,{children:[Object(D.jsx)(X.a,{children:"Name"}),Object(D.jsx)(X.a,{children:"Date created"}),Object(D.jsx)(X.a,{children:"Recipe Owner"})]})}),Object(D.jsx)(oe.a,{children:e.map((function(e){return Object(D.jsx)(ne,{recipe:e,handleCloneRecipe:r,handleShowRecipe:a,handleDeleteRecipe:c},e.id)}))})]})})},ue={caloriesIn:function(e){return(9*e.fooditem.fat+4*e.fooditem.protein+4*e.fooditem.carbohydrate)*e.amount/100},calcTotalCalOf:function(e){return e.reduce((function(e,t){return e+ue.caloriesIn(t)}),0)},calcTotalCarbsOf:function(e){return e.reduce((function(e,t){return e+t.fooditem.carbohydrate*t.amount/100}),0)},calcTotalFatOf:function(e){return e.reduce((function(e,t){return e+t.fooditem.fat*t.amount/100}),0)},calcTotalProteinOf:function(e){return e.reduce((function(e,t){return e+t.fooditem.protein*t.amount/100}),0)}},de=ue,je=n(262),be=n(284),pe=n(285),fe=n(256),Oe=function(e){var t=e.ingredient,n=(e.updateAmount,Object(f.b)()),r=Object(a.useState)(t.amount),c=Object(H.a)(r,2),o=(c[0],c[1]),i=Object(a.useState)(t.amount),s=Object(H.a)(i,2),l=s[0],u=s[1],b=Object(a.useState)(t.amount-50<0?0:t.amount-50),O=Object(H.a)(b,2),h=O[0],x=O[1],g=Object(a.useState)(Number(t.amount)+50),m=Object(H.a)(g,2),v=m[0],E=m[1];return Object(D.jsxs)(je.a,{children:[Object(D.jsx)(be.a,{children:Object(D.jsxs)(j.a,{direction:"row",flexGrow:1,justifyContent:"space-between",children:[Object(D.jsx)(d.a,{sx:{display:"inline-flex"},children:t.fooditem.name}),Object(D.jsxs)(d.a,{sx:{display:"flex",color:"text.secondary"},children:[t.amount," ",t.amountUnit]})]})}),Object(D.jsx)(pe.a,{children:Object(D.jsx)($.a,{sx:{ml:2},children:Object(D.jsxs)(j.a,{direction:"row",justifyContent:"space-between",spacing:3,children:[Object(D.jsx)(fe.a,{marks:[{value:h,label:"".concat(h," ").concat(t.amountUnit)},{value:v,label:"".concat(v," ").concat(t.amountUnit)}],min:h,max:v,value:l,onChange:function(e){o(e.target.value),u(e.target.value),e.target.value===h?(x(e.target.value-10<0?0:e.target.value-10),E(h+100)):e.target.value===v&&(E(v+10),x(h+10)),n(L(t.id,e.target.value))}}),Object(D.jsx)(p.a,{variant:"outlined",onClick:function(){console.log("attempt to delete ingredient",t),n({type:"DELETE_INGREDIENT",data:{ingredientId:t.id}})},children:Object(D.jsx)(te.a,{})})]})})})]})},he=n(264),xe=n(286),ge=n(269),me=n(287),ve=n(243),Ee=n(119),ye=n.n(Ee),we=n(138),Ce=n.n(we),Ie=n(270),Te=n(257),ke=n(283),Se=n(259),Re=n(260),Ae=n(263),De=n(251),Ne=Object(De.a)(),Fe=function(){var e=Object(f.c)((function(e){return e.fooditems})),t=Object(f.b)(),n=Object(a.useState)({name:""}),r=Object(H.a)(n,2),c=r[0],o=r[1],i=Object(a.useState)(0),s=Object(H.a)(i,2),d=s[0],O=s[1],h=Object(a.useState)("g"),x=Object(H.a)(h,2),g=x[0],m=x[1],v=Object(a.useState)(!1),E=Object(H.a)(v,2),y=E[0],w=E[1],C=Object(a.useState)(!1),I=Object(H.a)(C,2),T=I[0],k=I[1],S=function(){w(!1),k(!1),o({name:""}),O(0),m("g")};return Object(D.jsx)(D.Fragment,{children:Object(D.jsx)(l.a,{variant:"outlined",children:Object(D.jsxs)(u.a,{children:[Object(D.jsx)("form",{onSubmit:function(e){if(void 0!==e&&e.preventDefault(),null!==c)if(console.log("fooditem",c),console.log("amount",d),console.log("amountUnit",g),c.createNew)k(!0);else{var n={fooditemId:c.id,amount:d,amountUnit:g};t(U(n)),S(),console.log("new ingredient",n)}else window.alert("Please select a food from the menu")},onReset:S,children:Object(D.jsxs)(Ie.a,{fullWidth:!0,children:[Object(D.jsx)(Te.a,{disablePortal:!0,selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,freeSolo:!0,autoSelect:!0,id:"fooditemAutocomplete",value:c,options:e,getOptionLabel:function(e){return"string"===typeof e?e:e.name},onOpen:function(){return w(!0)},onChange:function(t,n){if("string"===typeof n){console.log("onchange found string");var a=e.find((function(e){return e.name===n}));a?(console.log("setting fooditem",a),o(a)):(console.log("Did not find fooditem, flagging for create"),o({name:n,createNew:!0}))}else n&&n.inputValue?(console.log("onchange found object"),console.log("Object",n),console.log("inputValue",n.inputValue),o({name:n.inputValue,createNew:!0})):(console.log("onchange found option from alternatives"),o(n))},renderOption:function(e,t){return Object(D.jsx)("li",Object(F.a)(Object(F.a)({},e),{},{children:t.name}))},renderInput:function(e){return Object(D.jsx)(b.a,Object(F.a)(Object(F.a)({},e),{},{label:"Add Ingredient"}))},filterOptions:function(e,t){var n=Ne(e,t),a=t.inputValue,r=e.some((function(e){return a===e.name}));return""===a||r||n.push({inputValue:a,name:'Create "'.concat(a,'"')}),n}}),Object(D.jsxs)(ke.a,{in:y,timeout:"auto",unmountOnExit:!0,children:[Object(D.jsx)(Ie.a,{fullWidth:!0,sx:{py:1},children:Object(D.jsx)(b.a,{id:"amount",label:"amount",type:"number",value:d,onChange:function(e){return O(e.target.value)}})}),Object(D.jsx)(Ie.a,{fullWidth:!0,sx:{py:0},children:Object(D.jsxs)(Se.a,{value:g,onChange:function(e){m(e.target.value)},children:[Object(D.jsx)(Re.a,{value:"g",children:"gram (g)"}),Object(D.jsx)(Re.a,{value:"ml",children:"milliliter (ml)"}),Object(D.jsx)(Re.a,{value:"tbsp",children:"tablespoon (tbsp)"}),Object(D.jsx)(Re.a,{value:"tsp",children:"teaspoon (tsp)"})]})}),Object(D.jsx)(Ie.a,{sx:{py:1},children:Object(D.jsxs)(j.a,{direction:"row",spacing:1,children:[Object(D.jsx)(p.a,{type:"submit",variant:"contained",children:"Add"}),Object(D.jsx)(p.a,{type:"reset",variant:"outlined",children:"Cancel"})]})})]})]})}),Object(D.jsx)(Ae.a,{open:T,onClose:function(){k(!1)},children:Object(D.jsx)(N,{fooditemObject:c,onCancel:function(){k(!1)},onSuccess:function(e){console.log("FooditemForm successfull in creating"),console.log(e),o(e);var n={fooditemId:e.id,amount:d,amountUnit:g};console.log("new Ingredient: ",n),t(U(n)),k(!1),S()}})})]})})})},_e=n(137),Pe=n.n(_e),Ue=n(136),Le=n.n(Ue),Me=function(){var e=Object(f.c)((function(e){return e.activeRecipe})),t=Object(f.c)((function(e){return e.fooditems})),n=Object(f.b)(),r=Object(z.f)(),c=Object(a.useState)(1),o=Object(H.a)(c,2),b=o[0],O=o[1],h=Object(a.useState)(!1),x=Object(H.a)(h,2),g=x[0],m=x[1],v=Object(a.useState)(""),E=Object(H.a)(v,2),y=E[0],w=E[1],C=null,I=Object(z.g)().id;if(Object(a.useEffect)((function(){var e=window.localStorage.getItem("savedRecipe".concat(I));if(e){console.log("found save:",JSON.parse(e));var t=JSON.parse(e);console.log(t),n(P(t.activeRecipe)),w(t.activeRecipe.title)}else G.getRecipe(I).then((function(e){n(P(e.data)),w(e.data.title)}))}),[]),!e)return Object(D.jsx)("p",{children:"Waiting for activeRecipe to be set"});if(0===t.length)return Object(D.jsx)(he.a,{item:!0,xs:12,children:Object(D.jsx)(xe.a,{})});console.log("Fooditems currently: ",t),C||(C=e.ingredients.map((function(e){var n=t.find((function(t){return t.id===e.fooditemId}));return void 0===n?(console.log("Fooditem in recipe not found in fooditem list"),{fooditem:{name:"<Deleted fooditem>",protein:0,fat:0,carbohydrate:0,id:0},amount:0,amountUnit:"g",id:e.id}):(e.fooditem=n,e)}))),console.log("ingredients:",C);var T=function(e,t){console.log("Want to save these changes: ",e,t)},S=function(){var t={activeRecipe:e,ingredients:C};console.log("saving following ingredients:",C),window.localStorage.setItem("savedRecipe".concat(I),JSON.stringify(t))},R=function(){var t=Object(s.a)(i.a.mark((function t(){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S(),t.prev=1,t.next=4,G.updateAllIngredients(e,C);case 4:a=t.sent,console.log("response return data",a.data),n(P(a.data)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),"undefined"!==typeof t.t0.response.data.error?n(k(t.t0.response.data.error)):"undefined"!==typeof t.t0.message?n(k(t.t0.message)):n(k("Some kind of error happened"));case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}(),A=function(){var t=Object(s.a)(i.a.mark((function t(a){var r,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),console.log(a.target.title.value),r={id:e.id,title:y},t.prev=3,t.next=6,G.updateRecipe(r);case 6:c=t.sent,console.log("received title",c.data.title),e.title=c.data.title,w(e.title),S(),n(P(e)),n({type:"UPDATE_RECIPE",data:e}),m(!1),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(3),console.log(t.t0),"undefined"!==typeof t.t0.response.data.error?n(k(t.t0.response.data.error)):"undefined"!==typeof t.t0.message?n(k(t.t0.message)):n(k("Some kind of error happened"));case 20:case"end":return t.stop()}}),t,null,[[3,16]])})));return function(e){return t.apply(this,arguments)}}();return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)(he.a,{item:!0,xs:12,children:[g?Object(D.jsx)("form",{onSubmit:A,children:Object(D.jsx)(ge.a,{size:"small",id:"recipe-title",inputProps:{style:{fontSize:35}},value:y,onChange:function(e){return w(e.target.value)},endAdornment:Object(D.jsxs)(me.a,{position:"end",children:[Object(D.jsx)(p.a,{type:"submit",children:Object(D.jsx)(ye.a,{})}),Object(D.jsx)(p.a,{onClick:function(){w(e.title),m(!1)},children:Object(D.jsx)(Le.a,{})})]}),name:"title"})}):Object(D.jsxs)(d.a,{variant:"h4",sx:{m:2},children:[e.title,Object(D.jsx)(p.a,{onClick:function(){return m(!g)},children:Object(D.jsx)(Pe.a,{})})]}),Object(D.jsxs)(j.a,{direction:"row",spacing:1,children:[Object(D.jsx)(p.a,{variant:"contained",startIcon:Object(D.jsx)(Ce.a,{}),onClick:R,children:"Server"}),Object(D.jsx)(p.a,{variant:"outlined",startIcon:Object(D.jsx)(ye.a,{}),onClick:S,children:"Local"}),Object(D.jsx)(p.a,{variant:"outlined",startIcon:Object(D.jsx)(te.a,{}),onClick:function(){window.localStorage.removeItem("savedRecipe".concat(I)),r.push("/")},children:"Discard changes"})]})]}),Object(D.jsx)(he.a,{item:!0,xl:4,lg:4,md:6,sm:8,xs:12,children:Object(D.jsxs)(l.a,{variant:"outlined",sx:{gridRow:"1",gridColumn:"span 2"},children:[Object(D.jsx)(u.a,{children:Object(D.jsx)(d.a,{variant:"h5",children:"Ingredients"})}),Object(D.jsxs)(u.a,{children:[Object(D.jsx)(Fe,{}),C.map((function(e){return Object(D.jsx)(Oe,{ingredient:e,updateAmount:T},e.id)}))]})]})}),Object(D.jsx)(he.a,{item:!0,xl:4,lg:4,md:6,sm:8,xs:12,children:Object(D.jsx)(l.a,{variant:"outlined",sx:{},children:Object(D.jsxs)(u.a,{children:[Object(D.jsx)(d.a,{variant:"h5",children:"Nutritional information"}),Object(D.jsxs)(re.a,{children:[Object(D.jsx)(ce.a,{children:Object(D.jsxs)(K.a,{children:[Object(D.jsx)(X.a,{children:"X"}),Object(D.jsx)(X.a,{children:"Total"}),Object(D.jsx)(X.a,{children:"Per serving"})]})}),Object(D.jsxs)(oe.a,{children:[Object(D.jsxs)(K.a,{children:[Object(D.jsx)(X.a,{children:"Calories"}),Object(D.jsx)(X.a,{children:de.calcTotalCalOf(C)}),Object(D.jsxs)(X.a,{children:[(de.calcTotalCalOf(C)/b).toFixed(0)," kcal"]})]}),Object(D.jsxs)(K.a,{children:[Object(D.jsx)(X.a,{children:"Carbs"}),Object(D.jsx)(X.a,{children:de.calcTotalCarbsOf(C)}),Object(D.jsxs)(X.a,{children:[(de.calcTotalCarbsOf(C)/b).toFixed(0)," g"]})]}),Object(D.jsxs)(K.a,{children:[Object(D.jsx)(X.a,{children:"Fat"}),Object(D.jsx)(X.a,{children:de.calcTotalFatOf(C)}),Object(D.jsxs)(X.a,{children:[(de.calcTotalFatOf(C)/b).toFixed(0)," g"]})]}),Object(D.jsxs)(K.a,{children:[Object(D.jsx)(X.a,{children:"Protein"}),Object(D.jsxs)(X.a,{children:[de.calcTotalProteinOf(C)," g"]}),Object(D.jsxs)(X.a,{children:[(de.calcTotalProteinOf(C)/b).toFixed(0)," g"]})]})]})]}),Object(D.jsxs)(d.a,{variant:"body1",children:["Number of servings: "," ",Object(D.jsx)(ve.a,{value:b,onChange:function(e){return O(e.target.value)},inputProps:{step:1,min:1,max:100,type:"number"},sx:{maxWidth:42}})]})]})})})]})},ze=n(139),We=n.n(ze),Ve=function(){var e=Object(f.c)((function(e){return e.fooditems})),t=Object(f.b)(),n=function(){var e=Object(s.a)(i.a.mark((function e(n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(w(n));case 2:(a=e.sent)?(console.log("received error: ",a.response.data.error),t(k(a.message+" - "+a.response.data.error,"error"))):console.log("retrnvalue null, success!");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsx)(he.a,{container:!0,spacing:2,flexWrap:"wrap",justifyContent:"flex-start",children:Object(D.jsxs)(he.a,{item:!0,xl:6,lg:8,md:10,sm:12,children:[Object(D.jsx)(d.a,{variant:"h4",sx:{m:2},children:"Fooditems"}),Object(D.jsx)(l.a,{children:Object(D.jsx)(u.a,{children:Object(D.jsxs)(re.a,{children:[Object(D.jsx)(ce.a,{children:Object(D.jsxs)(K.a,{children:[Object(D.jsx)(X.a,{children:"Name"}),Object(D.jsx)(X.a,{children:"Protein"}),Object(D.jsx)(X.a,{children:"Carbs"}),Object(D.jsx)(X.a,{children:"Fat"}),Object(D.jsx)(X.a,{children:"Actions"})]})}),Object(D.jsx)(oe.a,{children:e.map((function(e){return Object(D.jsxs)(K.a,{children:[Object(D.jsx)(X.a,{children:e.name}),Object(D.jsx)(X.a,{children:e.protein}),Object(D.jsx)(X.a,{children:e.carbohydrate}),Object(D.jsx)(X.a,{children:e.fat}),Object(D.jsx)(X.a,{children:Object(D.jsx)(p.a,{variant:"outlined",onClick:function(){return n(e.id)},children:Object(D.jsx)(We.a,{})})})]},e.id)}))})]})})})]})})},Ge=n(258),Je=function(){var e=Object(f.c)((function(e){return e.notification}));return e?Object(D.jsx)(Ge.a,{severity:"warning",children:e.messageText}):null},Ye=function(e){return{type:"SET_ACTIVE_USER",data:e}},Be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ACTIVE_USER":return t.data;case"CLEAR_ACTIVE_USER":return null;default:return e}},He=n(288),Ke=n(289),Xe=n(145),qe=n(290),Qe=n(140),Ze=n.n(Qe),$e=n(141),et=n.n($e),tt=n(120),nt=n.n(tt),at=n(65),rt=function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ct={loginUser:rt};function ot(e){var t=e.logout,n=Object(a.useState)(null),r=Object(H.a)(n,2),c=r[0],o=r[1],l=Object(a.useState)(null),u=Object(H.a)(l,2),j=u[0],O=u[1],h=Object(a.useState)(null),x=Object(H.a)(h,2),g=x[0],m=x[1],v=Object(f.c)((function(e){return e.loggedInUser})),y=Object(a.useState)(""),w=Object(H.a)(y,2),C=w[0],I=w[1],T=Object(a.useState)(""),k=Object(H.a)(T,2),S=k[0],R=k[1],A=Object(a.useState)(null),N=Object(H.a)(A,2),F=N[0],_=N[1],P=Object(f.b)(),U=function(){o(null)},L=function(){m(null),I(""),R("")},M=function(){O(null)},z=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log(C),console.log(S),e.prev=3,n={username:C,password:S},e.next=7,ct.loginUser(n);case 7:a=e.sent,console.log("token",a),P(Ye(a)),window.localStorage.setItem("MatappSavedLocalUser",JSON.stringify(a)),E.setToken(a.token),G.setToken(a.token),L(),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),console.log(e.t0.response.data.error),_(e.t0.response.data.error);case 20:console.log("submitted!");case 21:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,n={username:"guest",password:"guest"},e.next=5,ct.loginUser(n);case 5:a=e.sent,P(Ye(a)),window.localStorage.setItem("MatappSavedLocalUser",JSON.stringify(a)),E.setToken(a.token),G.setToken(a.token),L(),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0.response.data.error),_(e.t0.response.data.error);case 17:console.log("submitted!");case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsx)("div",{children:Object(D.jsx)(He.a,{position:"static",children:Object(D.jsxs)(Ke.a,{children:[Object(D.jsx)(nt.a,{sx:{display:{xs:"none",md:"flex"},mr:1}}),Object(D.jsx)(d.a,{variant:"h6",noWrap:!0,component:"div",sx:{mr:2,display:{xs:"none",md:"flex"},color:"inherit"},children:"RECIPES"}),Object(D.jsxs)($.a,{sx:{flexgrow:1,display:{xs:"flex",md:"none"}},children:[Object(D.jsx)(Q.a,{size:"medium",edge:"start",color:"inherit","aria-label":"menu",onClick:function(e){O(e.currentTarget)},sx:{mr:2},children:Object(D.jsx)(Ze.a,{})}),Object(D.jsxs)(Xe.a,{id:"menu-navigation",anchorEl:j,anchorOrigin:{vertical:"top",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:Boolean(j),onClose:M,sx:{display:{xs:"block",md:"none"}},children:[Object(D.jsx)(Re.a,{onClick:M,children:Object(D.jsx)(d.a,{textAlign:"center",component:at.b,to:"/",color:"inherit",textDecoration:"none",children:"Home"})}),Object(D.jsx)(Re.a,{onClick:M,children:Object(D.jsx)(d.a,{textAlign:"center",component:at.b,to:"/fooditems/",color:"inherit",textDecoration:"none",children:"Fooditems"})})]})]}),Object(D.jsx)(nt.a,{sx:{display:{xs:"flex",md:"none"},mr:1}}),Object(D.jsx)(d.a,{variant:"h6",noWrap:!0,component:"div",href:"/",sx:{mr:2,display:{xs:"flex",md:"none"},flexGrow:1,color:"inherit",textDecoration:"none"},children:"RECIPES"}),Object(D.jsxs)($.a,{sx:{flexGrow:1,display:{xs:"none",md:"flex"}},children:[Object(D.jsx)(p.a,{onClick:M,component:at.b,to:"/",sx:{my:2,color:"inherit",display:"block"},children:"Home"}),Object(D.jsx)(p.a,{onClick:M,component:at.b,to:"/fooditems/",sx:{my:2,color:"inherit",display:"block"},children:"Fooditems"})]}),Object(D.jsx)($.a,{sx:{flexGrow:1}}),v?Object(D.jsxs)($.a,{sx:{display:{xs:"flex",md:"flex"}},children:[Object(D.jsx)(d.a,{variant:"subtitle1",noWrap:!0,sx:{mr:2,display:{xs:"none",md:"flex"},alignItems:"center",color:"inherit",textDecoration:"none"},children:v.username}),Object(D.jsx)(qe.a,{title:"Open user menu",children:Object(D.jsx)(Q.a,{size:"large",onClick:function(e){console.log(e.currentTarget),o(e.currentTarget)},"aria-label":"test menu","aria-controls":"menu-appbar","aria-haspopup":"true",color:"inherit",children:Object(D.jsx)(et.a,{})})}),Object(D.jsxs)(Xe.a,{id:"menu-appbar",anchorEl:c,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,open:Boolean(c),onClose:U,children:[Object(D.jsx)(Re.a,{onClick:function(){t(),o(null)},children:"Logout"}),Object(D.jsx)(Re.a,{onClick:U,children:"Test2"})]})]}):Object(D.jsxs)($.a,{children:[Object(D.jsx)(p.a,{variant:"RouterLink",noWrap:!0,onClick:function(e){m(e.currentTarget)},sx:{mr:2,display:{xs:"flex",md:"flex"},alignItems:"center",color:"inherit",textDecoration:"none"},children:"Login"}),Object(D.jsxs)(Z.a,{component:"form",onSubmit:z,id:"login-menu",open:Boolean(g),anchorEl:g,onClose:L,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:[Object(D.jsx)($.a,{sx:{alignContent:"right"},children:Object(D.jsx)(d.a,{variant:"h6",sx:{color:"inherit",p:2},children:"Login"})}),Object(D.jsxs)($.a,{sx:{px:2,py:1},children:[Object(D.jsx)(b.a,{fullWidth:!0,value:C,onChange:function(e){return I(e.target.value)},controlId:"formUsername",id:"username",label:"username",variant:"filled"}),Object(D.jsx)("br",{})]}),Object(D.jsx)($.a,{sx:{px:2,py:1},children:Object(D.jsx)(b.a,{fullWidth:!0,value:S,onChange:function(e){return R(e.target.value)},id:"password",label:"password",variant:"filled",type:"password"})}),F?Object(D.jsx)(Ge.a,{severity:"warning",onClose:function(){return _(null)},children:F}):Object(D.jsx)(D.Fragment,{}),Object(D.jsxs)($.a,{sx:{p:2},children:[Object(D.jsx)(p.a,{variant:"contained",onClick:z,type:"submit",children:"Login"})," ",Object(D.jsx)(p.a,{onClick:L,variant:"contained",children:"Close"})," ",Object(D.jsx)(p.a,{variant:"outlined",onClick:W,children:"Login as guest"})]})]})]})]})})})}var it=n(261),st=n(144);var lt=function(){var e=Object(f.b)();Object(a.useEffect)((function(){var t=window.localStorage.getItem("MatappSavedLocalUser");if(t){var n=JSON.parse(t);e(Ye(n)),G.setToken(n.token),E.setToken(n.token)}}),[]),Object(a.useEffect)((function(){G.getAll().then((function(t){e({type:"INIT_RECIPES",data:t.data})}))}),[e]),Object(a.useEffect)((function(){E.getAll().then((function(t){e({type:"INIT_FOODITEMS",data:t.data})}))}),[e]);var t=Object(st.a)({palette:{primary:{light:"#4c8c4a",main:"#1a8145",dark:"#003300",contrastText:"#ffffff"},secondary:{light:"#8d4887",main:"#5e1b5a",dark:"#320030",contrastText:"#ffffff"}}});return Object(D.jsx)("div",{children:Object(D.jsxs)(it.a,{theme:t,children:[Object(D.jsx)(ot,{logout:function(){console.log("logout!"),window.localStorage.removeItem("MatappSavedLocalUser"),e({type:"CLEAR_ACTIVE_USER"}),E.setToken(null),G.setToken(null)}}),Object(D.jsx)(Je,{}),Object(D.jsxs)(z.c,{children:[Object(D.jsx)(z.a,{path:"/recipe/:id",children:Object(D.jsx)(he.a,{container:!0,spacing:2,flexWrap:"wrap",justifyContent:"flex-start",children:Object(D.jsx)(Me,{})})}),Object(D.jsx)(z.a,{path:"/recipe/",children:Object(D.jsx)(le,{})}),Object(D.jsx)(z.a,{path:"/fooditems/",children:Object(D.jsxs)("div",{className:"column",children:[Object(D.jsx)(Ve,{}),Object(D.jsx)(N,{})]})}),Object(D.jsx)(z.a,{path:"/",children:Object(D.jsx)(le,{})})]})]})})},ut=n(83),dt=n(142),jt=n(143),bt=Object(ut.combineReducers)({fooditems:C,recipes:B,activeRecipe:M,loggedInUser:Be,notification:A,timer:T}),pt=Object(ut.createStore)(bt,Object(dt.composeWithDevTools)(Object(ut.applyMiddleware)(jt.a)));c.a.render(Object(D.jsx)(at.a,{children:Object(D.jsx)(f.a,{store:pt,children:Object(D.jsx)(lt,{})})}),document.getElementById("root"))}},[[199,1,2]]]);
//# sourceMappingURL=main.35fdc9e1.chunk.js.map