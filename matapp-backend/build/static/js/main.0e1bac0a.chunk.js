(this["webpackJsonpmatapp-frontend"]=this["webpackJsonpmatapp-frontend"]||[]).push([[0],{34:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var c=n(1),i=n(19),r=n.n(i),a=n(4),o=n(12),d=n.n(o),l=n(14),u=n(11),s=n.n(u),j="/api/fooditems",b={getAll:function(){return console.log("getting all?"),s.a.get(j)},createFooditem:function(e){return s.a.post(j,e)},updateFooditem:function(e,t){return s.a.put("".concat(j,"/").concat(e),t)},deleteFooditem:function(e){return s.a.delete("".concat(j,"/").concat(e))}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_FOODITEMS":return t.data;case"ADD_FOODITEM":return e.concat(t.data);default:return e}},O=n(0),h=n(5),p=function(e){return{type:"SET_RECIPE",data:e}},m=function(e,t){return{type:"UPDATE_INGREDIENT_AMOUNT",data:{ingredientId:e,newAmount:t}}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_RECIPE":return t.data;case"ADD_INGREDIENT":var n=t.data,c=e.ingredients.concat(n);return Object(h.a)(Object(h.a)({},e),{},{ingredients:c});case"UPDATE_INGREDIENT_AMOUNT":var i=e.ingredients.find((function(e){return e.id===t.data.ingredientId})),r=Object(h.a)(Object(h.a)({},i),{},{amount:t.data.newAmount}),a=e.ingredients.map((function(e){return e.id!==r.id?e:r}));return Object(h.a)(Object(h.a)({},e),{},{ingredients:a});default:return e}},x=function(){var e=Object(a.c)((function(e){return e.fooditems})),t=Object(a.b)(),n=e.map((function(e){return{value:e.id,label:e.name}}));return Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:"Add Ingredient"}),Object(O.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),e.target.fooditem.value){var n,c={fooditemId:e.target.fooditem.value,amount:e.target.amount.value,amountUnit:e.target.amountUnit.value};e.target.amount.value="",e.target.amountUnit.value="g",console.log("new ingredient",c),t((n=c,console.log("Ingredient: ",n),{type:"ADD_INGREDIENT",data:Object(h.a)(Object(h.a)({},n),{},{id:Math.floor(1e4*Math.random())})}))}else window.alert("Please select a food from the menu")},children:[Object(O.jsx)("table",{children:Object(O.jsx)("tbody",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:"Food Name"}),Object(O.jsx)("td",{children:Object(O.jsx)("select",{name:"fooditem",children:n.map((function(e){return Object(O.jsx)("option",{value:e.value,children:e.label},e.value)}))})}),Object(O.jsx)("td",{children:"Amount"}),Object(O.jsxs)("td",{children:[Object(O.jsx)("input",{name:"amount"}),"Unit",Object(O.jsxs)("select",{name:"amountUnit",children:[Object(O.jsx)("option",{value:"g",children:"gram (g)"}),Object(O.jsx)("option",{value:"ml",children:"milliliter (ml)"}),Object(O.jsx)("option",{value:"tbsp",children:"tablespoon (tbsp)"}),Object(O.jsx)("option",{value:"tsp",children:"teaspoon (tsp)"})]})]})]})})}),Object(O.jsx)("button",{type:"submit",children:"Add Ingredient to recipe"})]})]})},v=n(38),I=n(3),E="/api/recipes",T={getAll:function(){return s.a.get(E)},getRecipe:function(e){return console.log("getting local recipe"),s.a.get("".concat(E,"/").concat(e))},createRecipe:function(e){return s.a.post(E,e)},updateRecipe:function(e){return s.a.put("".concat(E,"/").concat(e.id),e)},deleteRecipe:function(e){return s.a.delete("".concat(E,"/").concat(e))}},R=function(e){return{type:"ADD_RECIPE",data:e}},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_RECIPES":return t.data;case"ADD_RECIPE":return e.concat(t.data);case"UPDATE_RECIPE":var n=e.find((function(e){return e.id===t.data.id}));return console.log("Updated recipe ",n),e.map((function(e){return e.id!==t.data.id?e:t.data}));default:return e}},y=["id"],D=function(){var e=Object(a.c)((function(e){return e.recipes})),t=Object(a.b)(),n=Object(I.f)(),c=function(){var e=Object(l.a)(d.a.mark((function e(c){var i,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.id,i=Object(v.a)(c,y),console.log("WithoutID?",i),i=Object(h.a)(Object(h.a)({},i),{},{template:!1}),r=(new Date).toLocaleDateString("no-no"),i.title="".concat(i.title," - ").concat(r),console.log(i.name),e.next=8,T.createRecipe(i);case 8:a=e.sent,t(R(a.data)),n.push("/recipe/".concat(a.data.id));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(O.jsx)("ul",{children:e.map((function(e){return Object(O.jsxs)("li",{children:[e.title,e.template?Object(O.jsx)("button",{onClick:function(){return c(e)},children:"Make a copy and edit"}):Object(O.jsx)("button",{onClick:function(){return function(e){console.log("handled show recipe"),t(p(e)),n.push("/recipe/".concat(e.id))}(e)},children:"Set Active"})]},e.id)}))})},C={caloriesIn:function(e){console.log("IngredientCalc - ingredient:",e);return(9*e.fooditem.fat+4*e.fooditem.protein+4*e.fooditem.carbohydrate)*e.amount/100},calcTotalCalOf:function(e){return e.reduce((function(e,t){return e+C.caloriesIn(t)}),0)},calcTotalCarbsOf:function(e){return e.reduce((function(e,t){return e+t.fooditem.carbohydrate*t.amount/100}),0)},calcTotalFatOf:function(e){return e.reduce((function(e,t){return e+t.fooditem.fat*t.amount/100}),0)},calcTotalProteinOf:function(e){return e.reduce((function(e,t){return e+t.fooditem.protein*t.amount/100}),0)}},N=C,A=n(22),S=(n(34),function(e){var t=e.ingredient,n=(e.updateAmount,Object(a.b)()),i=Object(c.useState)(!1),r=Object(A.a)(i,2),o=r[0],d=r[1],l=Object(c.useState)(t.amount),u=Object(A.a)(l,2),s=u[0],j=u[1],b=Object(c.useState)(t.amount),f=Object(A.a)(b,2),h=f[0],p=f[1];return o?Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{style:{width:100},onClick:function(){return d(!o)},children:t.fooditem.name}),Object(O.jsxs)("td",{children:[Object(O.jsx)("input",{value:s,size:"10",onChange:function(e){var c,i=e.target;return c=i.value,j(c),p(c),void n(m(t.id,c))}}),t.amountUnit]}),Object(O.jsxs)("td",{children:[Object(O.jsx)("button",{onClick:function(){return function(){var e=s;j(e+1),p(e+1),n(m(t.id,e+1))}()},children:"Increase"}),Object(O.jsx)("button",{onClick:function(){return function(){if(s>0){var e=s;j(e-1),p(e-1),n(m(t.id,e-1))}}()},children:"Decrease"}),Object(O.jsx)("input",{value:h,type:"range",min:"0",max:"1000",onChange:function(e){j(e.target.value),p(e.target.value),n(m(t.id,e.target.value))}})]})]}):Object(O.jsxs)("tr",{onClick:function(){return d(!o)},children:[Object(O.jsx)("td",{style:{width:100},children:t.fooditem.name}),Object(O.jsxs)("td",{style:{width:120},children:[t.amount," ",t.amountUnit]}),Object(O.jsx)("td",{})]})}),_=function(){var e=Object(a.c)((function(e){return e.activeRecipe})),t=Object(a.c)((function(e){return e.fooditems})),n=Object(a.b)(),i=Object(I.f)(),r=null,o=Object(I.g)().id;if(Object(c.useEffect)((function(){var e=window.localStorage.getItem("savedRecipe".concat(o));if(e){console.log("found save:",JSON.parse(e));var t=JSON.parse(e);console.log(t),n(p(t.activeRecipe))}else T.getRecipe(o).then((function(e){n(p(e.data))}))}),[]),!e)return Object(O.jsx)("p",{children:"Waiting for activeRecipe to be set"});if(0===t.length)return Object(O.jsx)("p",{children:"Waiting for foodItems"});console.log("Fooditems currently: ",t),r||(r=e.ingredients.map((function(e){var n=t.find((function(t){return t.id===e.fooditemId}));return console.log("found fooditem",n),e.fooditem=n,e}))),console.log("ingredients:",r);var u=function(e,t){console.log("Want to save these changes: ",e,t)};console.log("ingredients",r);var s=function(){var t={activeRecipe:e,ingredients:r};console.log("saving following ingredients:",r),window.localStorage.setItem("savedRecipe".concat(o),JSON.stringify(t))},j=function(){var t=Object(l.a)(d.a.mark((function t(){var c,i,r,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s(),c=e.ingredients,i=c.map((function(e){return delete e.fooditem,e})),r=Object(h.a)(Object(h.a)({},e),{},{ingredients:i}),t.next=6,T.updateRecipe(r);case 6:a=t.sent,n(p(a.data));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(O.jsxs)("div",{children:[Object(O.jsx)("h1",{children:e.title}),Object(O.jsx)("button",{onClick:s,children:"Save changes locally"}),Object(O.jsx)("button",{onClick:function(){window.localStorage.removeItem("savedRecipe".concat(o)),i.push("/")},children:"Discard changes and return"}),Object(O.jsx)("button",{onClick:j,children:"Save to server"}),Object(O.jsx)("h2",{children:"Ingredients"}),Object(O.jsx)("table",{children:Object(O.jsx)("tbody",{children:r.map((function(e){return Object(O.jsx)(S,{ingredient:e,updateAmount:u},e.id)}))})}),Object(O.jsx)("h2",{children:"Nutritional information"}),Object(O.jsxs)("table",{children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:"Total calories"}),Object(O.jsx)("td",{children:"Total protein"}),Object(O.jsx)("td",{children:"Total carbs"}),Object(O.jsx)("td",{children:"Total fat"})]})}),Object(O.jsx)("tbody",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:N.calcTotalCalOf(r)}),Object(O.jsx)("td",{children:N.calcTotalProteinOf(r)}),Object(O.jsx)("td",{children:N.calcTotalCarbsOf(r)}),Object(O.jsx)("td",{children:N.calcTotalFatOf(r)})]})})]})]})},k=n(21);var P=function(){Object(a.c)((function(e){return e.fooditems})),Object(a.c)((function(e){return e.activeRecipe}));var e=Object(a.b)();Object(c.useEffect)((function(){T.getAll().then((function(t){e({type:"INIT_RECIPES",data:t.data})}))}),[e]),Object(c.useEffect)((function(){b.getAll().then((function(t){e({type:"INIT_FOODITEMS",data:t.data})}))}),[e]);var t=function(){return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{className:"header",children:Object(O.jsx)("h1",{children:"Recipe stuff"})}),Object(O.jsx)("div",{className:"topnav",children:Object(O.jsx)(k.b,{to:"/",children:"Home"})})]})};return Object(O.jsxs)("div",{children:[Object(O.jsx)(t,{}),Object(O.jsxs)(I.c,{children:[Object(O.jsxs)(I.a,{path:"/recipe/:id",children:[Object(O.jsx)("div",{className:"column",children:Object(O.jsx)(_,{})}),Object(O.jsx)("div",{className:"column",children:Object(O.jsx)(x,{})})]}),Object(O.jsx)(I.a,{path:"/recipe/",children:Object(O.jsx)(D,{})}),Object(O.jsx)(I.a,{path:"/",children:Object(O.jsx)(D,{})})]})]})},U=n(16),F=n(36),M=n(37),J=Object(U.combineReducers)({fooditems:f,recipes:w,activeRecipe:g}),W=Object(U.createStore)(J,Object(F.composeWithDevTools)(Object(U.applyMiddleware)(M.a)));r.a.render(Object(O.jsx)(k.a,{children:Object(O.jsx)(a.a,{store:W,children:Object(O.jsx)(P,{})})}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.0e1bac0a.chunk.js.map